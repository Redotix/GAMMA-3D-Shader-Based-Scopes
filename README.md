# GAMMA-3D-Shader-Based-Scopes
A collection of mods that add 3D Shader Based scope support to GAMMA weapons and other weapon packs

<a href="https://github.com/Redotix/GAMMA-3D-Shader-Based-Scopes/blob/main/README-ru.md">Russian Tutorial</a>

<h2>Credits</h2>
Andtheherois - creating all these packs<br/>
Party50 - creating the original 3DSS mod<br/>
NLTP_ASHES- creating the lense hiding script<br/>
LVuter - massive help with EXE edits and Shaders<br/>
Redotix - EXE edits<br/>

<h1><u> Dependencies </u></h1>
You need these for 3DSS to work.
<ol>
  <li><a href="https://github.com/andtheherois/Mark-Switch-10-GAMMA-ver./releases">Mark Switch</a> Install through MO2 like any other mod.</li>
  <li><a href="https://drive.google.com/file/d/1_l5pFjFpcDJueh9FRohRJwJSgtSV5azh/view">Meowie's scope textures</a> Install trough MO2 like any other mod.</li>
  <li><a href="https://github.com/themrdemonized/STALKER-Anomaly-modded-exes">Latest Version of Demonized modded EXEs</a> If your GAMMA install is up to date, you should no longer need to install EXEs separately.</li>
  <li>DISABLE **137- Auto-Zoomed Out Scope Draw - Demonized** IN MO2</li>
  <li>In the manim menu, go into settings > modded exes and enable shader scopes smooth zoom change.</li>
  <li>Make sure SMAA and Anti-Aliasing is turned off in your stalker graphics settings</li>
</ol>

<h1><u> Downloads </u></h1>

  <a href="https://github.com/Redotix/3DSS-for-GAMMA/releases">3DSS for GAMMA</a>
  This is the main mod, it is required if you want to install any other 3DSS packs.

<h2><u>Compatibility mods</u></h2>
<p>These add 3DSS compatibility for other mods, you need the original mods to use these.</p><br />
<ul>
  <li><a href="https://github.com/andtheherois/3DSS-For-BAS22/releases">
    3DSS-For-BAS22
  </a> --> <a href="https://github.com/andtheherois/3DSS-For-BAS22/blob/main/README.md">
    Original mod</a></li>
  
  <li><a href="https://github.com/andtheherois/3DSS-No-BAS-folding-stock-AKs/releases">
    3DSS-No-BAS-folding-stock-AKs
  </a> --> <a href="https://github.com/andtheherois/3DSS-No-BAS-folding-stock-AKs/blob/main/README.md">
    Original mod</a></li>
    
  <li><a href="https://github.com/andtheherois/3DSS-for-Reanimated-Vanilla-Replacements/releases">
    3DSS-for-Reanimated-Vanilla-Replacements
  </a> --> <a href="https://github.com/andtheherois/3DSS-for-Reanimated-Vanilla-Replacements/blob/main/README.md">
    Original mod</a></li>

  <li><a href="https://github.com/andtheherois/3DSS-for-EFPWP---ATHI-Edit/releases">
    3DSS-for-EFPWP---ATHI-Edit
  </a> --> <a href="https://github.com/andtheherois/3DSS-for-EFPWP---ATHI-Edit/blob/main/README.md">
    Original mod</a></li>
                   
  <li><a href="https://github.com/andtheherois/3DSS-for-JUAN-s-Guns/releases">
    3DSS-for-JUAN-s-Guns
  </a> --> <a href="https://github.com/andtheherois/3DSS-for-JUAN-s-Guns/blob/main/README.md">
    Original mod</a></li>
        
  <li><a href="https://github.com/andtheherois/3DSS-for-FG42/releases">
    3DSS-for-FG42
  </a> --> <a href="https://github.com/andtheherois/3DSS-for-FG42/blob/main/README.md">
    Original mod</a></li>
               
  <li><a href="https://github.com/andtheherois/3DSS-for-Milkor-GL/releases">
    3DSS-for-Milkor-GL
  </a> --> <a href="https://github.com/andtheherois/3DSS-for-Milkor-GL/blob/main/README.md">
    Original mod</a></li>
</ul>

<h2><u>Standalone mods</u></h2>
<p></p>These are weapon mods that aleady have 3DSS built in.</p><br />
<ul>
  <li><a href="https://github.com/andtheherois/3DSS-Re-Enabled-Guns/releases">
    3DSS-Re-Enabled-Guns</a></li>
  
  <li><a href="https://github.com/andtheherois/AUG-A3-Custom-Replacer-for-3DSS/releases">
    AUG-A3-Custom-Replacer-for-3DSS</a></li>
  
  <li><a href="https://github.com/andtheherois/3DSS-TX15-Reanimation/releases">
    3DSS-TX15-Reanimation</a></li>
      
  <li><a href="https://github.com/andtheherois/3DSS-M4-Skyraga-Reanimation/releases">
    3DSS-M4-Skyraga-Reanimation</a></li>
      
  <li><a href="https://github.com/andtheherois/3DSS-M4A1-Siber-Reanimation/releases">
    3DSS-M4A1-Siber-Reanimation</a></li>
      
  <li><a href="https://github.com/andtheherois/3DSS-IWP-SV98-Port/releases">
    3DSS-IWP-SV98-Port</a></li>

  <li><a href="https://github.com/andtheherois/3DSS-for-SIG-SPEAR/releases">
    3DSS-SIG-MCX-SPEAR</a></li>

  <li><a href="https://github.com/andtheherois/3DSS-Saiga23/releases">
    3DSS-Saiga23</a></li>
    
  <li><a href="https://github.com/andtheherois/3DSS-SVU-PMC/releases">
    3DSS-SVU-PMC</a></li>
    
  <li><a href="https://github.com/andtheherois/3DSS-AK101-SP/releases">
    3DSS-AK101-SP</a></li>    

  <li><a href="https://github.com/andtheherois/3DSS-RPD-Custom/releases">
    3DSS-RPD-Custom</a></li>
    
  <li><a href="https://github.com/andtheherois/3DSS-Mateba-Unica/releases">
    3DSS-Mateba-unica</a></li>
    
  <li><a href="https://github.com/andtheherois/3DSS-VEPR762x544/releases">
    3DSS-VEPR762x54</a></li>
    
  <li><a href="https://github.com/andtheherois/3DSS-KAC-Freak-PDW/releases">
    3DSS-KAC-Freak-PDW</a></li>
    
  <li><a href="https://github.com/andtheherois/3DSS-Groza-Custom/releases">
    3DSS-Groza-Custom</a></li> 

  <li><a href="https://github.com/andtheherois/3DSS-PSG1A1/releases">
    3DSS-PSG1A1</a></li>   

  <li><a href="https://github.com/andtheherois/3DSS-SR25-PMC/releases">
    3DSS-SR25-PMC</a></li>
    
  <li><a href="https://github.com/andtheherois/3DSS-The-Covenant-Weapon-Pack---ATHI-Edit/releases">
    3DSS-The-Covenant-Weapon-Pack</a></li>

  <li><a href="https://github.com/andtheherois/3DSS-EFT-Weapons-pack/releases">
    3DSS-EFT MK47, MP155 Ultima, MK14 SASS</a></li>
    
  <li><a href="https://github.com/andtheherois/3DSS-Gunslinger-Gauss/releases">
    3DSS-Gunslinger-Gauss</a></li> 
    
   <li><a href="https://github.com/andtheherois/3DSS-Gunslinger-Ak101/releases">
    3DSS-Gunslinger-AK101</a></li> 
    
   <li><a href="https://github.com/andtheherois/3DSS-AK103-Bullpup/releases">
    3DSS-AK103-Bullpup</a></li>    

  <li><a href="https://github.com/andtheherois/3DSS-Gungnir/releases">
    3DSS-Gungnir</a></li> 
    
   <li><a href="https://github.com/andtheherois/3DSS-RFB/releases">
    3DSS-RFB</a></li>   
    
  <li><a href="https://github.com/andtheherois/3DSS-LEWD-FAMAS/releases">
    3DSS-LEWD-FAMAS-ATHI-Edit</a></li>    

  <li><a href="https://github.com/andtheherois/3DS-ISG-AK-Makeover/releases">
    3DSS-ISG-AK-Makeover</a></li>

  <li><a href="https://github.com/andtheherois/3DSS-HOWA20-Makeover/releases">
    3DSS-HOWA20-Makeover</a></li>
    
  <li><a href="https://github.com/andtheherois/3DSS-M4-Tactical-Reanimation-and-Remodel/releases">
    3DSS-M4-Tactical-Reanimation-and-Remodel</a></li>

  <li><a href="https://github.com/andtheherois/3DSS-M98B-Reanimation/releases">
    3DSS-M98B-Reanimation</a></li>       
</ul>

<h1><u> Install Guide </u></h1>

<ol>
  <li>Make sure you have done everything from the <b>Dependencies</b> section</li>
  <li><b>Install 3DSS for GAMMA</b> This should be far down on your priority list. At least below ALL weapon mods. This should always load before any other 3DSS mods. Other 3DSS mods must load after this. <b>There should be NO weapon mods in between any of the 3DSS mods.</b></li>
  <li>Install any other 3DSS mods under GAMMA Scopes. <b>YOU MUST HAVE THE ORIGINAL MODS FOR THEM TO WORK. THEY DO NOT INCLUDE THE ORIGINAL MOD!</b></li>
  <li>Delete your Shader Cache: Anomaly > appdata > shaders_cache - delete</li>
</ol>

Example load order
![image](https://github.com/Redotix/GAMMA-3D-Shader-Based-Scopes/assets/118221809/3cdfad76-f9a1-493e-a1bd-4cda7325e21b)


<h1><u> TO DO </u></h1>
<ul>
  <li> Fix SSS ghosting</li> - PARTIALLY DONE
  <li> Fix Reshade ghosting</li>
  <li> Fix Beef NVG tube switching</li> (can be fixed by using Improved Beef's NVGs mod)
  <li> Clean up code</li> - DONE
  <li> Remove the need for a lense hiding script </li>
  <li> Merge exe edits with Demonized repo</li> - DONE
  <li> Deal with transparent/emissive objects showing up inside scopes</li> - DONE
  <li> Fix various low poly scope windows</li> - DONE
</ul>

<h1><u> LOOKING FOR HELP </u></h1>
If anyone understands graphics programming and the stalker source that wants to help, here are the rendering issues that I was not able to solve:

<ul>
  <li> Currently the mod requires 3 different lenses with 3 different shaders to be defined in the ogf file, this could be improved by only defining a single lense which we then render 3 times in the engine, this however requires all 3 shaders to be defined and precompiled inside the game engine as to my knowledge its not possible to force render with a shader that is compiled at runtime</li>
  <li> The shader thats responsible for restoring the zbuffer inside the scope has ztesting turned off, as the ztest always failed since the lense contained the depth information of whats behind the scope. Preffarably it would be nice to fix it so we can ztest (or use a stencil test) because lenses are sometimes deep inside a scope, causing them to be rendere over the top of the socpe (currently we just disable the 3rd lense while not aiming down sights)</li>
  <li> The Biggest issue currently is that our "zoom effect" we do inside the scope only affects the color render target and therefor doesnt zoom in the image inside the zbuffer or the position rt, this causes some effects from SSS and effects from Reshade that use the zbuffer to render incorrecly inside the scope. I dont know how to fix this as I wasnt able to sample the zbuffer or the position rt inside the reticle pixel shader</li>
</ul>

If you need me to clarify anything about any of these issues or you want to try and help us solve them, please contact me on discord: redotix99
